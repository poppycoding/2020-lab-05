define("question-new:widget/js/share/share",function(i,e){function t(i){var e=["toolbar=0,status=0,resizable=1,width=",i.width||440,",height=",i.height||430,",left=",(screen.width-(i.width||440))/2,",top=",(screen.height-(i.height||430))/2].join("");window.open(i.url,"shareWindow",e)||(location.href=i.url)}function n(i,e){var t={render:document.createElement("canvas").getContext?"canvas":"table",width:e.width,height:e.height,text:e.href};F.context("weixinShareTinyUrl")?(t.text=F.context("weixinShareTinyUrl"),i.qrcode(t)):o.ajax({url:"/api/gettinyurl",type:"POST",dataType:"json",data:{url:e.href}}).done(function(e){var n=e.data;0===e.errno?(F.context("weixinShareTinyUrl",n.tinyurl),t.text=n.tinyurl,i.qrcode(t)):i.qrcode(t)}).fail(function(){i.qrcode(t)})}var o=i("common:widget/js/util/tangram/tangram"),a=i("common:widget/js/util/log/log");i("common:widget/js/logic/qrcode/qrcode"),e.init=function(i){if(i.target&&i.pageUrl&&i.title){var e=o(i.target),r=i.pageUrl,s=-1===r.indexOf("?")?"?":"&",c={url:r+s+"sharesource=qzone",title:i.title,pics:i.pic||"https://gss0.bdstatic.com/70cFsjip0QIZ8tyhnq/img/iknow/zhidaologo.png"},h={url:r+s+"sharesource=weibo",title:i.weiboTitle||i.title,pic:i.pic||"https://gss0.bdstatic.com/70cFsjip0QIZ8tyhnq/img/iknow/zhidaologo.png"};i.summary&&(c.summary=i.summary,h.summary=i.summary);var l=[],d=[];for(var g in c)l.push(g+"="+encodeURIComponent(c[g]||""));for(var g in h)d.push(g+"="+encodeURIComponent(h[g]||""));var w="http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?"+l.join("&"),u="http://v.t.sina.com.cn/share/share.php?"+d.join("&"),p=o('<div class="wgt-share-btn"><i class="wgt-share-icon ikonw-qb-new-icon"></i>∑÷œÌ</div>'),m=o(['<div class="wgt-share-content">','<div class="wgt-share-triangle1"></div><div class="wgt-share-triangle2"></div>','<div class="wgt-share-weixin"><span class="ikonw-qb-new-icon logo"></span>Œ¢–≈…®“ª…®</div>','<div class="wgt-share-qrcode"><div class="weixin-qrcode-img"></div></div>','<div data-url="'+u+'"class="others-share-item wgt-share-weibo">','<span class="ikonw-qb-new-icon logo"></span>–¬¿ÀŒ¢≤©</div>','<div data-url="'+w+'"class="others-share-item wgt-share-qzone">','<span class="ikonw-qb-new-icon logo"></span>QQø’º‰</div>',"</div>"].join(""));e.html(p),e.append(m),e.on("click",".wgt-share-weibo, .wgt-share-qzone",function(){var e=o(this),n={url:e.data("url")};if(e.hasClass("wgt-share-weibo"))var r="weibo-click";else{n.width=800,n.height=600;var r="qzone-click"}t(n),i.logOpt&&(i.logOpt.action="share-click-"+r,a.send(i.logOpt))}).on("click",".wgt-share-btn",function(e){e.stopPropagation(),m.find(".weixin-qrcode-img").children().size()||n(m.find(".weixin-qrcode-img"),{width:100,height:100,href:r+s+"sharesource=weixin"}),o(".wgt-share-content").each(function(i,e){o(e)!==m&&o(e).hide()}),m.toggle(),i.logOpt&&(i.logOpt.action="share-view",a.send(i.logOpt)),o("body").one("click",function(){m.hide()})})}}});