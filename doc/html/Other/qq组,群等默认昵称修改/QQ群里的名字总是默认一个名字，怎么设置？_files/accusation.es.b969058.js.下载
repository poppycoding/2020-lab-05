define("question-new:widget/view/accusation/accusation.es",function(t,e,i){"use strict";var n=t("common:widget/js/util/event/event"),s=t("common:widget/lib/jquery/jquery"),c=t("common:widget/js/ui/dialog/dialog");i.exports={target:s("#js-accuse"),init:function(){this.bindEvents()},initParams:function(t){{var e=t.itemid,i=t.typeid,n=t.userid,s=t.qid;this.target}0===i?F.context("accusePostData",{type:1,qid:e,rid:0,uid:n}):F.context("accusePostData",{type:2,qid:s,rid:e,uid:n})},bindEvents:function(){var t=this,e=this.target,i=e.find("#js-accuse-closebtn"),o=e.find("#js-accuse-btn-cancel"),a=e.find("#js-accuse-btn-submit"),d=e.find("#js-accuse-content"),u=e.find("#js-accuse-words-current"),r=e.find("#js-errmsg"),l="selected",m="disabled",f=function(){e.find(".js-accuse-type-item").removeClass(l),a.addClass(m),d.val(""),u.html(0)};n.on("action-accuse-show",function(i,s){t.initParams(s.params),e.show(),n.fire("showMask")}).on("action-accuse-close",function(){e.hide(),f(),n.fire("hideMask")});var w=function(){n.fire("action-accuse-close")};i.on("click",w),o.on("click",w),a.on("click",function(t){if(a.hasClass(m))return void t.preventDefault();var n=e.find(".js-accuse-type-item."+l).data("reason"),o=F.context("accusePostData");o.reason=n,o.content=d.val().trim(),s.ajax({url:"/submit/index/report",type:"POST",dataType:"json",data:o,cache:!1,success:function(t){var e=t.errno,n=t.errmsg;switch(i.trigger("click"),e){case 0:new c({content:'<div class="ui-dialog-content-title">举报成功</div><div class="ui-dialog-content-text">工作人员会在48小时内处理<br />处理结果请关注系统通知<br />感谢您对百度知道的支持</div>',width:300,height:170,className:"ui-question-widget",close:function(){window.location.reload(!0)},autoDispose:!0}),setTimeout(function(){c.close()},2e3);break;case 4:new c({content:"您的当日举报量已超上限，感谢您的百度知道的支持。",width:300,height:100,className:"ui-question-widget",close:function(){window.location.reload(!0)},autoDispose:!0});break;case 5:var s=1===o.type?"问题":"回答";new c({content:'<div class="ui-dialog-content-title">您已经举报了该'+s+'</div><div class="ui-dialog-content-text">我们会尽快处理，请不要重复举报</div>',width:300,height:120,className:"ui-question-widget",close:function(){window.location.reload(!0)},autoDispose:!0}),setTimeout(function(){c.close()},2e3);break;default:new c({content:n,width:300,height:100,className:"ui-question-widget",close:function(){window.location.reload(!0)},autoDispose:!0})}}})}),e.on("click",".js-accuse-type-item",function(t){e.find(".js-accuse-type-item").removeClass(l);var i=s(t.target),n=d.val().trim().length;i.addClass(l),500>=n&&a.removeClass(m)}).on("click",".tort-entry",function(){var t=F.context("accusePostData");t&&(1===t.type?window.open("/misc/tortreportcontentlist?qid="+t.qid+"&type=1"):2===t.type&&window.open("/misc/tortreportcontentlist?qid="+t.qid+"&rid="+t.rid+"&type=2"),n.fire("action-accuse-close"))}),d.on("input",function(){var t=d.val().trim().length;u.html(t);var i=t-200;i>0?(r.html("您已超出"+i+"个文字"),a.addClass(m)):(r.html(""),e.find(".js-accuse-type-item").hasClass(l)&&a.removeClass(m))})}}});